import{b as C,u as I,r as l,A as L,l as R,j as e,x as U,B as j,c as k,K as O}from"./app-65fbab72.js";import{b as B,a as K,e as M,A as g,m as T,t as Y,v as q,w as S,x as c,y as G,z as i,E as H}from"./Tracker-33d5ea18.js";import{n as J}from"./numberFormatter-373bc269.js";import{P as Q}from"./index-0cba895a.js";import"./Transition-da004935.js";import"./default-config-939e3be8.js";function se({fpo_id:h,agent_id:u}){var _;const $=C(),p=I(s=>s.auth.token),{updateAppContextState:P}=l.useContext(L),[o,v]=l.useState(1),[d,m]=l.useState(1),[E,A]=l.useState(1),[y,F]=l.useState(""),[b,z]=l.useState(""),[n,f]=l.useState({});let x=`${j}/farmers`;h&&(x=`${j}/fpo/${h}/farmers`),u&&(x=`${j}/agent/${u}/farmers`);const r=(s=x)=>{P("loading",!0),console.log(s),k.get(s,{headers:{API_KEY:O,Authorization:`Bearer ${p}`}}).then(a=>{var N;let t=a==null?void 0:a.data;(h||u)&&(t=(N=a.data)==null?void 0:N.data),console.log("Profiles",t),a!=null&&a.data&&(v(parseInt(t==null?void 0:t.current_page)),F(t==null?void 0:t.prev_page_url),z(t==null?void 0:t.next_page_url),A(t==null?void 0:t.last_page),f(t))}).catch(a=>{console.log(a)}).finally(()=>{P("loading",!1)})},w=R.debounce(r,1e3);return l.useEffect(()=>{r()},[p]),l.useEffect(()=>{d!=o&&m(o)},[o]),l.useEffect(()=>{d!=o&&w(`${x}?page=${d}`)},[d]),e.jsx("div",{className:"w-full h-full py-4",children:e.jsxs(B,{className:"bg-white h-full w-full",children:[e.jsxs(K,{justifyContent:"start",className:"space-x-2",children:[e.jsx(M,{children:"Farmers"}),e.jsx(g,{color:"gray",children:J(parseInt((n==null?void 0:n.total)||0))})]}),e.jsx(T,{className:"mt-2",children:"Overview of farmers profiled"}),e.jsxs(Y,{className:"mt-6",children:[e.jsx(q,{children:e.jsxs(S,{children:[e.jsx(c,{children:"Farmer ID"}),e.jsx(c,{children:"Name"}),e.jsx(c,{children:"Phone"}),e.jsx(c,{children:"FPO"}),e.jsx(c,{className:"",children:"District"}),e.jsx(c,{className:"",children:"Registered On"}),e.jsx(c,{className:"",children:"Status"}),e.jsx(c,{children:"Link"})]})}),e.jsx(G,{children:(_=n==null?void 0:n.data)==null?void 0:_.map(s=>{var a,t;return e.jsxs(S,{children:[e.jsxs(i,{children:["# ",s.farmer_id]}),e.jsx(i,{children:s.first_name+" "+s.last_name}),e.jsx(i,{children:s.phone_number}),e.jsx(i,{children:s.fpo_name||((a=s==null?void 0:s.fpo)==null?void 0:a.fpo_name)}),e.jsx(i,{className:"",children:s.district}),e.jsx(i,{children:(t=new Date(s==null?void 0:s.created_at))==null?void 0:t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}),e.jsx(i,{children:s.status==="complete"?e.jsx(g,{className:"capitalize",size:"md",color:"green",children:s==null?void 0:s.status}):e.jsx(g,{className:"capitalize",size:"md",color:"red",children:s==null?void 0:s.status})}),e.jsx(i,{children:e.jsx(H,{size:"xs",variant:"secondary",color:"orange",onClick:()=>{$(`${U}/${s==null?void 0:s.farmer_id}`)},children:"See details"})})]},s.id)})})]}),e.jsx(Q,{currentPage:o,moveToPage:d,fetchPage:r,setMoveToPage:m,nextPageUrl:b,prevPageUrl:y,lastPage:E,totalPages:n==null?void 0:n.last_page})]})})}export{se as default};
