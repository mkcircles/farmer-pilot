import{b as I,u as w,r as l,A as L,l as R,j as s,x as U,B as j,c as k,K as B}from"./app-2af70224.js";import{b as O,a as K,e as M,A as g,m as T,t as Y,v as q,w as $,x as n,y as G,z as i,E as H}from"./Tracker-1908a2fb.js";import{n as J}from"./numberFormatter-373bc269.js";import{P as Q}from"./index-8aa0a7aa.js";import"./Transition-0d92bb52.js";import"./default-config-939e3be8.js";function es({fpo_id:h,agent_id:r}){var _;const v=I(),p=w(e=>e.auth.token),{updateAppContextState:P}=l.useContext(L),[o,f]=l.useState(1),[d,m]=l.useState(1),[E,S]=l.useState(1),[A,F]=l.useState(""),[b,z]=l.useState(""),[c,y]=l.useState({});let x=`${j}/farmers`;h&&(x=`${j}/fpo/${h}/farmers`),r&&(x=`${j}/agent/${r}/farmers`);const u=(e=x)=>{P("loading",!0),console.log(e),k.get(e,{headers:{API_KEY:B,Authorization:`Bearer ${p}`}}).then(a=>{var N;let t=a==null?void 0:a.data;(h||r)&&(t=(N=a.data)==null?void 0:N.data),console.log("Profiles",t),a!=null&&a.data&&(f(parseInt(t==null?void 0:t.current_page)),F(t==null?void 0:t.prev_page_url),z(t==null?void 0:t.next_page_url),S(t==null?void 0:t.last_page),y(t))}).catch(a=>{console.log(a)}).finally(()=>{P("loading",!1)})},C=R.debounce(u,1e3);return l.useEffect(()=>{u()},[p]),l.useEffect(()=>{d!=o&&m(o)},[o]),l.useEffect(()=>{d!=o&&C(`${x}?page=${d}`)},[d]),s.jsx("div",{className:"w-full h-full py-4",children:s.jsxs(O,{className:"bg-white h-full w-full",children:[s.jsxs(K,{justifyContent:"start",className:"space-x-2",children:[s.jsx(M,{children:"Farmers"}),s.jsx(g,{color:"gray",children:J(parseInt((c==null?void 0:c.total)||0))})]}),s.jsx(T,{className:"mt-2",children:"Overview of farmers profiled"}),s.jsxs(Y,{className:"mt-6",children:[s.jsx(q,{children:s.jsxs($,{children:[s.jsx(n,{children:"Farmer ID"}),s.jsx(n,{children:"Name"}),s.jsx(n,{children:"Phone"}),s.jsx(n,{children:"FPO"}),s.jsx(n,{className:"",children:"District"}),s.jsx(n,{className:"",children:"Status"}),s.jsx(n,{children:"Link"})]})}),s.jsx(G,{children:(_=c==null?void 0:c.data)==null?void 0:_.map(e=>{var a;return s.jsxs($,{children:[s.jsxs(i,{children:["# ",e.farmer_id]}),s.jsx(i,{children:e.first_name+" "+e.last_name}),s.jsx(i,{children:e.phone_number}),s.jsx(i,{children:e.fpo_name||((a=e==null?void 0:e.fpo)==null?void 0:a.fpo_name)}),s.jsx(i,{className:"",children:e.district}),s.jsx(i,{children:e.status==="complete"?s.jsx(g,{className:"capitalize",size:"md",color:"green",children:e==null?void 0:e.status}):s.jsx(g,{className:"capitalize",size:"md",color:"red",children:e==null?void 0:e.status})}),s.jsx(i,{children:s.jsx(H,{size:"xs",variant:"secondary",color:"orange",onClick:()=>{v(`${U}/${e==null?void 0:e.farmer_id}`)},children:"See details"})})]},e.id)})})]}),s.jsx(Q,{currentPage:o,moveToPage:d,fetchPage:u,setMoveToPage:m,nextPageUrl:b,prevPageUrl:A,lastPage:E,totalPages:c==null?void 0:c.last_page})]})})}export{es as default};
