import{b as k,u as O,r as n,A as B,l as M,j as e,F as T,B as S,d as K,Q}from"./app-8aa1c6f7.js";import{b as Y,a as q,e as G,A as j,m as H,t as J,v as V,w as F,x as i,y as W,z as o,F as X}from"./Tracker-cd468549.js";import{n as Z}from"./numberFormatter-373bc269.js";import{P as r}from"./index-677a7afe.js";import"./Transition-3cbf21f6.js";import"./default-config-939e3be8.js";function lt({fpo_id:P,agent_id:_,...a}){var E;const m=k(),$=O(t=>t.auth.token),{updateAppContextState:v}=n.useContext(B),[d,y]=n.useState(1),[h,b]=n.useState(1),[z,A]=n.useState(1),[w,C]=n.useState(""),[I,L]=n.useState(""),[c,R]=n.useState({});let g=`${S}/farmers`;P&&(g=`${S}/fpo/${P}/farmers`),_&&(g=`${S}/agent/${_}/farmers`);const N=(t=g)=>{v("loading",!0),a!=null&&a.bio_url&&(t=a==null?void 0:a.bio_url),console.log(t),K.get(t,{headers:{API_KEY:Q,Authorization:`Bearer ${$}`}}).then(l=>{var u,x;let s=l==null?void 0:l.data;(P||_)&&(s=(u=l.data)==null?void 0:u.data),a!=null&&a.bio_url&&(s=(x=l.data)==null?void 0:x.data),console.log("Profiles",s),l!=null&&l.data&&(y(parseInt(s==null?void 0:s.current_page)),C(s==null?void 0:s.prev_page_url),L(s==null?void 0:s.next_page_url),A(s==null?void 0:s.last_page),R(s))}).catch(l=>{console.log(l)}).finally(()=>{v("loading",!1)})},U=M.debounce(N,1e3);return n.useEffect(()=>{N()},[$]),n.useEffect(()=>{h!=d&&b(d)},[d]),n.useEffect(()=>{h!=d&&U(`${g}?page=${h}`)},[h]),e.jsx("div",{className:"w-full h-full py-4",...a,children:e.jsxs(Y,{className:"bg-white h-full w-full",children:[e.jsxs(q,{justifyContent:"start",className:"space-x-2",children:[e.jsx(G,{children:"Farmers"}),e.jsx(j,{color:"gray",children:Z(parseInt((c==null?void 0:c.total)||0))})]}),e.jsx(H,{className:"mt-2",children:"Overview of farmers profiled"}),e.jsxs(J,{className:"mt-6",children:[e.jsx(V,{children:e.jsxs(F,{children:[e.jsx(i,{children:"Farmer ID"}),e.jsx(i,{children:"Name"}),e.jsx(i,{children:"Phone"}),e.jsx(i,{children:"FPO"}),e.jsx(i,{className:"",children:"District"}),e.jsx(i,{className:"",children:"Registered On"}),e.jsx(i,{className:"",children:"Status"}),e.jsx(i,{children:"Link"})]})}),e.jsx(W,{children:(E=c==null?void 0:c.data)==null?void 0:E.map(t=>{var l,s,u,x;return e.jsxs(F,{children:[e.jsx(o,{children:t.farmer_id}),e.jsx(o,{children:t.first_name+" "+t.last_name}),e.jsx(o,{children:t.phone_number}),e.jsx(o,{children:t.fpo_name||((l=t==null?void 0:t.fpo)==null?void 0:l.fpo_name)||((u=(s=t==null?void 0:t.agent)==null?void 0:s.fpo)==null?void 0:u.fpo_name)}),e.jsx(o,{className:"",children:t.district}),e.jsx(o,{children:(x=new Date(t==null?void 0:t.created_at))==null?void 0:x.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}),e.jsx(o,{children:t.status==="complete"?e.jsx(j,{className:"capitalize",size:"md",color:"green",children:t==null?void 0:t.status}):(t==null?void 0:t.status)==="pending"?e.jsx(j,{className:"capitalize",size:"md",color:"gray",children:t==null?void 0:t.status}):e.jsx(j,{className:"capitalize",size:"md",color:"red",children:t==null?void 0:t.status})}),e.jsx(o,{children:e.jsx(X,{size:"xs",variant:"secondary",color:"orange",onClick:()=>{m(`${T}/${t==null?void 0:t.farmer_id}`)},children:"See details"})})]},t.id)})})]}),e.jsx(r,{currentPage:d,moveToPage:h,fetchPage:N,setMoveToPage:b,nextPageUrl:I,prevPageUrl:w,lastPage:z,totalPages:c==null?void 0:c.last_page})]})})}export{lt as default};
