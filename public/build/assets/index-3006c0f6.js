import{b as R,u as U,r as l,A as k,l as O,j as t,F as B,B as j,d as T,T as M}from"./app-2d77318b.js";import{b as K,a as Y,e as q,A as u,m as G,t as H,v as J,w as v,x as a,y as Q,z as i,F as V}from"./Tracker-9e248fef.js";import{n as W}from"./numberFormatter-373bc269.js";import{P as X}from"./index-b6ea816c.js";import"./Transition-18176916.js";import"./default-config-939e3be8.js";function ns({fpo_id:p,agent_id:P,...A}){var S;const E=R(),_=U(s=>s.auth.token),{updateAppContextState:N}=l.useContext(k),[o,F]=l.useState(1),[d,r]=l.useState(1),[m,y]=l.useState(1),[z,b]=l.useState(""),[w,C]=l.useState(""),[c,I]=l.useState({});let x=`${j}/farmers`;p&&(x=`${j}/fpo/${p}/farmers`),P&&(x=`${j}/agent/${P}/farmers`);const g=(s=x)=>{N("loading",!0),T.get(s,{headers:{API_KEY:M,Authorization:`Bearer ${_}`}}).then(n=>{var h;let e=(h=n==null?void 0:n.data)==null?void 0:h.data;console.log("Profiles",e),n!=null&&n.data&&(F(parseInt(e==null?void 0:e.current_page)),b(e==null?void 0:e.prev_page_url),C(e==null?void 0:e.next_page_url),y(e==null?void 0:e.last_page),I(e))}).catch(n=>{console.log(n)}).finally(()=>{N("loading",!1)})},L=O.debounce(g,1e3);return l.useEffect(()=>{g()},[_]),l.useEffect(()=>{d!=o&&r(o)},[o]),l.useEffect(()=>{d!=o&&L(`${x}?page=${d}`)},[d]),t.jsx("div",{className:"w-full h-full py-4",...A,children:t.jsxs(K,{className:"bg-white h-full w-full",children:[t.jsxs(Y,{justifyContent:"start",className:"space-x-2",children:[t.jsx(q,{children:"Farmers"}),t.jsx(u,{color:"gray",children:W(parseInt((c==null?void 0:c.total)||0))})]}),t.jsx(G,{className:"mt-2",children:"Overview of farmers profiled"}),t.jsxs(H,{className:"mt-6",children:[t.jsx(J,{children:t.jsxs(v,{children:[t.jsx(a,{children:"Farmer ID"}),t.jsx(a,{children:"Name"}),t.jsx(a,{children:"Phone"}),t.jsx(a,{children:"FPO"}),t.jsx(a,{className:"",children:"District"}),t.jsx(a,{className:"",children:"Registered On"}),t.jsx(a,{className:"",children:"Status"}),t.jsx(a,{children:"Link"})]})}),t.jsx(Q,{children:(S=c==null?void 0:c.data)==null?void 0:S.map(s=>{var n,e,h,$;return t.jsxs(v,{children:[t.jsx(i,{children:s.farmer_id}),t.jsx(i,{children:s.first_name+" "+s.last_name}),t.jsx(i,{children:s.phone_number||"N/A"}),t.jsx(i,{children:s.fpo_name||((n=s==null?void 0:s.fpo)==null?void 0:n.fpo_name)||((h=(e=s==null?void 0:s.agent)==null?void 0:e.fpo)==null?void 0:h.fpo_name)}),t.jsx(i,{className:"",children:s.district}),t.jsx(i,{children:($=new Date(s==null?void 0:s.created_at))==null?void 0:$.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}),t.jsx(i,{children:s.status==="complete"?t.jsx(u,{className:"capitalize",size:"md",color:"green",children:s==null?void 0:s.status}):(s==null?void 0:s.status)==="pending"?t.jsx(u,{className:"capitalize",size:"md",color:"gray",children:s==null?void 0:s.status}):t.jsx(u,{className:"capitalize",size:"md",color:"red",children:s==null?void 0:s.status})}),t.jsx(i,{children:t.jsx(V,{size:"xs",variant:"secondary",color:"orange",onClick:()=>{E(`${B}/${s==null?void 0:s.farmer_id}`)},children:"See details"})})]},s.id)})})]}),t.jsx(X,{currentPage:o,moveToPage:d,fetchPage:g,setMoveToPage:r,nextPageUrl:w,prevPageUrl:z,lastPage:m,totalPages:c==null?void 0:c.last_page})]})})}export{ns as default};
