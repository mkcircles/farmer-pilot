import{a as E,b as k,r,A as P,u as C,j as e,B as _,c as T,v as $,_ as F,f as z,L as f,E as B}from"./app-fd9a0fe1.js";import{L as m,S as D,P as L,i as U,f as R,j as V,k as O,g as q,l as G}from"./index-9ba32a41.js";import{B as I}from"./index-9310d218.js";import{e as W,l as X,o as H,A as g,b as J,d as K,h as Q,i as v,n as Y,j as N}from"./Tracker-c96fce1c.js";import{F as A}from"./index-02b05679.js";import{F as b}from"./index-d291c77b.js";import{T as Z}from"./tablet-2365f31f.js";import{W as y}from"./WithConfirmAlert-7915c474.js";import"./square-stack-e404997d.js";import"./tw-merge-fbb83fc6.js";import"./default-config-939e3be8.js";import"./Transition-51b55348.js";const ee=({showModal:j,setShowModal:x,agent:l,setAgentData:s})=>{const h=E();k();const{updateAppContextState:u}=r.useContext(P),p=C(t=>{var o;return(o=t.auth)==null?void 0:o.token}),[a,c]=r.useState({agent_id:l==null?void 0:l.id,brand:"",device_id:"",assigned_phone_number:""}),d=()=>{u("loading",!0),axios.post(`${_}/agent/device/add`,{...a,agent_id:l==null?void 0:l.id},{headers:{Authorization:`Bearer ${p}`}}).then(t=>{x(!1),s({...l,device_id:`${a==null?void 0:a.brand}-${a==null?void 0:a.device_id}`}),h(T({id:$(),message:"Device has been Issued successfully"}))}).catch(t=>{}).finally(()=>{u("loading",!1)})};return e.jsxs("div",{className:`z-[1000] fixed bg-primary rounded-md shadow-md transition-all h-full top-32 bottom-0 right-0 w-full lg:w-1/2 duration-700  ${j?"  translate-x-0  ":"translate-x-full"}`,children:[e.jsxs("div",{className:"flex w-full space-x-8 p-4 ",children:[e.jsx("span",{className:"text-white",onClick:()=>x(!1),children:e.jsx(m,{icon:"XSquare"})}),e.jsxs(W,{className:"text-white",children:["Issue Device to ",(l==null?void 0:l.first_name)+" "+(l==null?void 0:l.last_name)]})]}),e.jsx("div",{className:"h-full flex flex-col bg-slate-50",children:e.jsxs("form",{className:"py-8 px-8",onSubmit:t=>{t.preventDefault(),d()},children:[e.jsxs("div",{className:"py-4",children:[e.jsx(b,{htmlFor:"brand",children:"Brand"}),e.jsx(X,{value:a==null?void 0:a.brand,onValueChange:t=>c({...a,brand:t}),children:["Samsung Active Tab Pro - SM-T540 (Wi-Fi only)","Samsung Active Tab Pro - SM-T547 (LTE)","Famoco FX 205 SE","Samsung Galaxy Tab Active 3","Samsung A53 (SM-A536U1 model only)"].map((t,o)=>e.jsx(H,{value:t,icon:Z,children:t},o))})]}),e.jsxs("div",{className:"py-4",children:[e.jsx(b,{htmlFor:"name",children:"Device ID"}),e.jsx(A,{id:"device_id",required:!0,type:"text",placeholder:"",value:a==null?void 0:a.device_id,onChange:t=>c({...a,device_id:t.target.value})})]}),e.jsxs("div",{className:"py-4",children:[e.jsx(b,{htmlFor:"name",children:"Assigned Phone Number"}),e.jsx(A,{id:"assigned_phone_number",required:!0,type:"text",placeholder:"",value:a==null?void 0:a.assigned_phone_number,onChange:t=>c({...a,assigned_phone_number:t.target.value})})]}),e.jsx("div",{className:"flex py-4",children:e.jsx(I,{variant:"primary",className:"w-full",onClick:()=>{},children:"Save"})})]})})]})},S=r.lazy(()=>F(()=>import("./index-5f043ec7.js"),["assets/index-5f043ec7.js","assets/app-fd9a0fe1.js","assets/app-be85fb0a.css","assets/Tracker-c96fce1c.js","assets/Transition-51b55348.js","assets/default-config-939e3be8.js","assets/numberFormatter-373bc269.js","assets/index-d50537eb.js"])),se=r.lazy(()=>F(()=>import("./index-cd6f2d1c.js"),["assets/index-cd6f2d1c.js","assets/app-fd9a0fe1.js","assets/app-be85fb0a.css","assets/Tracker-c96fce1c.js","assets/Transition-51b55348.js","assets/default-config-939e3be8.js","assets/numberFormatter-373bc269.js","assets/index-d50537eb.js"]));function ue(){const j=k(),x=C(i=>i.auth.token),{updateAppContextState:l}=r.useContext(P),[s,h]=r.useState(null),[u,p]=r.useState(!1),[a,c]=r.useState(!1),d=r.useRef(null);let{agent_code:t}=z();r.useEffect(()=>{l("loading",!0),axios.get(`${_}/agent/${t}`,{headers:{Authorization:`Bearer ${x}`}}).then(({data:i})=>{console.log("Agent Data",i.data),i!=null&&i.data&&h(i==null?void 0:i.data)}).catch(i=>{console.log(i)}).finally(()=>{l("loading",!1)})},[t]),r.useEffect(()=>{setTimeout(()=>{var i;(i=d==null?void 0:d.current)==null||i.scrollIntoView({behavior:"smooth"})},3e3)},[d]);const o=i=>new Promise((M,w)=>{l("loading",!0),axios.put(`${_}/agent/status/update`,{agent_id:s==null?void 0:s.id,status:i},{headers:{Authorization:`Bearer ${x}`}}).then(({data:n})=>{if(console.log("Agent Data",n.data),n!=null&&n.data)return h(n==null?void 0:n.data),M({message:i==="active"?"Agent has been activated":i==="inactive"?"Agent has been deactivated":i==="suspended"?"Agent has been suspended":"Agent has been blacklisted",title:"success"});w({message:"Something went wrong",title:"error"})}).catch(n=>{console.log(n),w({message:"Something went wrong",title:"error"})}).finally(()=>{l("loading",!1)})});return s?e.jsxs(e.Fragment,{children:[e.jsx(ee,{agent:s,showModal:u,setShowModal:p,setAgentData:h}),e.jsxs("div",{ref:d,className:"flex flex-col items-center mt-8 intro-y sm:flex-row",children:[e.jsx("h2",{className:"flex items-center mr-auto text-lg font-medium",children:"Agent Profile"}),e.jsx("div",{className:"flex w-full mt-4 space-x-2 sm:w-auto sm:mt-0",children:e.jsxs(I,{onClick:()=>{c(!a)},variant:"primary",className:"mr-2 shadow-md",children:[e.jsx(m,{icon:"Settings",className:"w-4 h-4 mr-2"})," ","Manage Agent Account"]})})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-5 mt-5 relative",children:[e.jsx("div",{className:"col-span-12",children:e.jsx("div",{className:"px-3 pt-3 pb-5 box intro-y",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-center lg:flex-row lg:text-left",children:[e.jsx("div",{className:"z-20 lg:-mt-10 lg:ml-10",children:e.jsx("div",{className:"w-40 h-40 overflow-hidden border-4 border-white rounded-full shadow-md image-fit",children:e.jsx("img",{alt:"Profile Photo",className:"rounded-md",src:s==null?void 0:s.photo})})}),e.jsxs("div",{className:"lg:ml-5",children:[e.jsxs("h2",{className:"mt-5 text-lg font-medium",children:[e.jsx("span",{children:(s==null?void 0:s.first_name)+" "+(s==null?void 0:s.last_name)}),e.jsx("span",{className:"relative -top-1 -right-1",children:(s==null?void 0:s.status)==="active"?e.jsx(g,{className:"capitalize shadow-md bg-green-300",size:"sm",color:"green",children:s==null?void 0:s.status}):e.jsx(g,{className:"capitalize",size:"sm",color:"orange",children:s==null?void 0:s.status})})]}),e.jsxs("div",{className:"flex items-center justify-center mt-2 text-slate-500 lg:justify-start",children:[e.jsx(m,{icon:"Briefcase",className:"w-4 h-4 mr-2"})," ",s==null?void 0:s.designation]}),e.jsxs("div",{className:"flex items-center justify-center mt-2 text-slate-500 lg:justify-start",children:[e.jsx(m,{icon:"MapPin",className:"w-4 h-4 mr-2"})," ",s==null?void 0:s.residence,", UG"]})]}),e.jsxs("div",{className:"grid h-24 grid-cols-2 px-10 mx-auto mb-6 border-dashed gap-y-2 md:gap-y-0 lg:border-l lg:border-r border-slate-200 lg:mb-0",children:[e.jsxs("div",{className:"flex items-center justify-center col-span-2 md:col-span-1 lg:justify-start",children:[e.jsx(m,{icon:"Phone",className:"w-4 h-4 mr-2"}),s==null?void 0:s.phone_number]}),e.jsxs("div",{className:"flex items-center justify-center col-span-2 md:col-span-1 lg:justify-start",children:[e.jsx(m,{icon:"Mail",className:"w-4 h-4 mr-2"}),s==null?void 0:s.email]}),e.jsxs("div",{className:"flex items-center justify-center col-span-2 md:col-span-1 lg:justify-start",children:[e.jsx("span",{className:"w-fit h-4 mr-2 flex items-center opacity-75",children:"Referee:"}),s==null?void 0:s.referee_name]}),e.jsxs("div",{className:"flex items-center justify-center col-span-2 md:col-span-1 lg:justify-start",children:[e.jsx("span",{className:"w-fit h-4 mr-2 flex items-center opacity-75",children:"Referee Phone:"}),s==null?void 0:s.referee_phone_number]}),e.jsxs("div",{className:"flex items-center justify-center col-span-2 lg:justify-start",children:[e.jsx(m,{icon:"SmartphoneCharging",className:"w-4 h-4 mr-2"}),s!=null&&s.device_id?e.jsxs("span",{className:"text-primary font-thin",children:[s==null?void 0:s.device_id," |"," ",s==null?void 0:s.assigned_phone_number]}):e.jsx("span",{className:"text-white bg-primary px-2 rounded",children:"Device Not Issued"})]})]})]})})}),e.jsxs("div",{className:`flex flex-col absolute transition-all duration-700 sm:end-0 end-auto w-48 mr-1 ${a?"-top-4 z-50 h-fit box":"top-8 z-50 h-0 overflow-hidden"}`,children:[e.jsxs("div",{onClick:()=>{p(!0),c(!1)},className:"flex border-b space-x-2 p-4 items-center cursor-pointer",children:[e.jsx(D,{className:"w-5 h-5 text-secondary "}),e.jsx("span",{className:"text-primary",children:"Issue Device"})]}),e.jsxs("div",{onClick:()=>{j(B,{state:{agent:s}})},className:"flex border-b space-x-2 p-4 items-center cursor-pointer",children:[e.jsx(L,{className:"w-5 h-5 text-secondary "}),e.jsx("span",{className:"text-primary",children:"Edit Information"})]}),(s==null?void 0:s.status)!=="active"&&e.jsxs("div",{onClick:()=>{y(()=>o("active")),c(!1)},className:"flex border-b space-x-2 p-4 items-center cursor-pointer",children:[e.jsx(U,{className:"w-5 h-5 text-secondary "}),e.jsx("span",{className:"text-primary",children:"Activate Account"})]}),(s==null?void 0:s.status)!=="suspended"&&e.jsxs("div",{onClick:()=>{y(()=>o("suspended")),c(!1)},className:"flex border-b space-x-2 p-4 items-center cursor-pointer",children:[e.jsx(R,{className:"w-5 h-5 text-secondary "}),e.jsx("span",{className:"text-primary",children:"Suspend Account"})]}),(s==null?void 0:s.status)!=="blacklisted"&&e.jsxs("div",{onClick:()=>{y(()=>o("blacklisted")),c(!1)},className:"flex border-b space-x-2 p-4 items-center cursor-pointer",children:[e.jsx(V,{className:"w-5 h-5 text-secondary "}),e.jsx("span",{className:"text-primary",children:"Blacklist Account"})]})]})]}),e.jsx("div",{className:"w-full h-full mt-4",children:e.jsx(J,{children:e.jsxs(K,{children:[e.jsxs(Q,{className:"",children:[e.jsx(v,{icon:O,children:"All Farmers Profiled"}),e.jsx(v,{icon:q,children:"Invalid Farmer Profiles"}),e.jsx(v,{icon:G,children:"Valid Farmer Profiles"})]}),e.jsxs(Y,{children:[e.jsx(N,{children:e.jsx(r.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(se,{className:"py-0",agent_id:s==null?void 0:s.id})})}),e.jsx(N,{children:e.jsx(r.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(S,{status:"invalid",subTitle:"Overview of Invalid Farmer Profiles",agent_id:s==null?void 0:s.id})})}),e.jsx(N,{children:e.jsx(r.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(S,{status:"valid",subTitle:"Overview of Valid Farmer Profiles",agent_id:s==null?void 0:s.id})})})]})]})})})]}):e.jsx(f,{})}export{ue as default};
