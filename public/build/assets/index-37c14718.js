import{b as T,u as R,r as l,A as w,B as j,l as Y,j as e,D as M,d as q,P as H}from"./app-25da55ac.js";import{b as g,a as J,e as K,A as G,m as _,t as Q,v as V,w as L,x as o,y as W,z as d,F as X,u as Z,s as y,d as D,h as ee,i as A,n as se,j as N}from"./Tracker-2ee0a400.js";import{n as $}from"./numberFormatter-373bc269.js";import{P as te}from"./index-09d89ba6.js";import{S as ie,C as ae,a as le}from"./square-stack-f94cf408.js";import"./Transition-afe206db.js";import"./default-config-939e3be8.js";function v(r){var F,I;const x=T(),c=R(t=>t.auth.token),{updateAppContextState:P}=l.useContext(w),[m,B]=l.useState(1),[h,p]=l.useState(1),[u,s]=l.useState(1),[f,S]=l.useState(""),[b,U]=l.useState(""),[n,z]=l.useState({}),E=(r==null?void 0:r.biometrics_api_url)||`${j}/farmers/bio`,C=(t=E)=>{P("loading",!0),q.get(t,{headers:{API_KEY:H,Authorization:`Bearer ${c}`}}).then(i=>{var k;let a=(k=i.data)==null?void 0:k.data;console.log("Profiles",a),i!=null&&i.data&&(B(parseInt(a==null?void 0:a.current_page)),S(a==null?void 0:a.prev_page_url),U(a==null?void 0:a.next_page_url),s(a==null?void 0:a.last_page),z(a))}).catch(i=>{console.log(i)}).finally(()=>{P("loading",!1)})},O=Y.debounce(C,1e3);return l.useEffect(()=>{C()},[c]),l.useEffect(()=>{h!=m&&p(m)},[m]),l.useEffect(()=>{h!=m&&O(`${E}?page=${h}`)},[h]),e.jsx("div",{className:"w-full h-full py-4",children:((F=n==null?void 0:n.data)==null?void 0:F.length)>0?e.jsxs(g,{className:"bg-white h-full w-full",children:[e.jsxs(J,{justifyContent:"start",className:"space-x-2",children:[e.jsx(K,{children:"Biometrics"}),e.jsx(G,{color:"gray",children:$(parseInt((n==null?void 0:n.total)||0))})]}),e.jsxs(_,{className:"mt-2",children:["Overview of ",(r==null?void 0:r.title)||"Biometrics captured"]}),e.jsxs(Q,{className:"mt-6",children:[e.jsx(V,{children:e.jsxs(L,{children:[e.jsx(o,{children:"Farmer ID"}),e.jsx(o,{children:"Name"}),e.jsx(o,{children:"Enrollment Status"}),e.jsx(o,{children:"Possible Duplicate"}),e.jsx(o,{className:"",children:"Has BioToken"}),e.jsx(o,{className:"",children:"Reason"}),e.jsx(o,{className:"",children:"Registered On"}),e.jsx(o,{className:"",children:"Subject ID"}),e.jsx(o,{children:"Link"})]})}),e.jsx(W,{children:(I=n==null?void 0:n.data)==null?void 0:I.map(t=>{var a;let i=t.farmer_profile;return e.jsxs(L,{children:[e.jsx(d,{children:i.farmer_id}),e.jsx(d,{children:i.first_name+" "+i.last_name}),e.jsx(d,{children:t==null?void 0:t.enrollmentStatus}),e.jsx(d,{children:t!=null&&t.possible_duplicate?"Yes":"No"}),e.jsx(d,{className:"",children:t!=null&&t.hasBiometricToken?"Yes":"No"}),e.jsx(d,{className:"",children:(t==null?void 0:t.reason)||"No Reason"}),e.jsx(d,{children:(a=new Date(i==null?void 0:i.created_at))==null?void 0:a.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}),e.jsx(d,{children:t==null?void 0:t.subjectID}),e.jsx(d,{children:e.jsx(X,{size:"xs",variant:"secondary",color:"orange",onClick:()=>{x(`${M}/${i==null?void 0:i.farmer_id}`)},children:"See details"})})]},i.id)})})]}),e.jsx(te,{currentPage:m,moveToPage:h,fetchPage:C,setMoveToPage:p,nextPageUrl:b,prevPageUrl:f,lastPage:u,totalPages:n==null?void 0:n.last_page})]}):e.jsx(g,{className:"flex justify-center items-center border border-dashed p-16 border-gray-300",children:e.jsx(_,{children:"No data"})})})}const xe=()=>{const r=R(u=>u.auth.token),{updateAppContextState:x}=l.useContext(w),[c,P]=l.useState({}),[m,B]=l.useState({}),h=(u=`${j}/summary`)=>{x("loading",!0),axios.get(u,{headers:{Authorization:`Bearer ${r}`}}).then(s=>{console.log("Stats Data",s==null?void 0:s.data);let f=s==null?void 0:s.data;s!=null&&s.data&&B(f)}).catch(s=>{console.log(s)}).finally(()=>{x("loading",!1)})},p=(u=`${j}/bio/summary`)=>{x("loading",!0),axios.get(u,{headers:{Authorization:`Bearer ${r}`}}).then(s=>{var S,b;console.log("Bio Summary Data",(S=s==null?void 0:s.data)==null?void 0:S.data);let f=(b=s==null?void 0:s.data)==null?void 0:b.data;s!=null&&s.data&&P(JSON.parse(f))}).catch(s=>{console.log(s)}).finally(()=>{x("loading",!1)})};return l.useEffect(()=>{h(),p()},[]),e.jsxs(e.Fragment,{children:[e.jsxs(Z,{numItemsSm:2,numItemsLg:3,className:"gap-6 mt-4",children:[e.jsxs(g,{children:[e.jsx(_,{children:"Biometrics Captured"}),e.jsx(y,{children:$(c==null?void 0:c.bio_summary)})]}),e.jsxs(g,{children:[e.jsx(_,{children:"Failed Captures"}),e.jsx(y,{children:$(c==null?void 0:c.denied_captures)})]}),e.jsxs(g,{children:[e.jsx(_,{children:"Possibe Duplicates"}),e.jsx(y,{children:$(c==null?void 0:c.possible_duplicates)})]})]}),e.jsx(g,{className:"mt-4",children:e.jsxs(D,{children:[e.jsxs(ee,{className:"",children:[e.jsx(A,{icon:ie,children:"Biometrics Captured"}),e.jsx(A,{icon:ae,children:"Failed Captures"}),e.jsx(A,{icon:le,children:"Possible Duplicates"})]}),e.jsxs(se,{children:[e.jsx(N,{children:e.jsx(v,{title:"All Biometrics Captures",biometrics_api_url:`${j}/farmers/bio`})}),e.jsx(N,{children:e.jsx(v,{title:"Failed Captures",biometrics_api_url:`${j}/farmers/bio/failed`})}),e.jsx(N,{children:e.jsx(v,{title:"Possible Duplicates",biometrics_api_url:`${j}/farmers/bio/duplicates`})}),e.jsx(N,{})]})]})})]})};export{xe as default};
