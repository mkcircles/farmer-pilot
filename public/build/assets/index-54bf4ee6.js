import{v as k,u as y,r as a,A as m,B as g,D as B,j as e,b as M,c as K,i as T,M as j,n as G,m as H,G as J,H as W,I as A,J as c,K as Y,L as i,bd as q,W as Q,N as V,O as X,be as Z}from"./app-ffa37ed4.js";function f({fpo_id:P,agent_id:_,...b}){var v;const r=k(),N=y(s=>s.auth.token),o=y(s=>s.auth.user),{updateAppContextState:$}=a.useContext(m),[d,z]=a.useState(1),[h,S]=a.useState(1),[F,I]=a.useState(1),[L,C]=a.useState(""),[R,U]=a.useState(""),[l,w]=a.useState({});let x=`${g}/farmers`;(o==null?void 0:o.role)!=="admin"&&(x=`${g}/fpo/${o==null?void 0:o.entity_id}/farmers`),P&&(x=`${g}/fpo/${P}/farmers`),_&&(x=`${g}/agent/${_}/farmers`);const p=(s=x)=>{$("loading",!0),X.get(s,{headers:{API_KEY:Z,Authorization:`Bearer ${N}`}}).then(n=>{var u;let t=(u=n==null?void 0:n.data)==null?void 0:u.data;console.log("Profiles",t),n!=null&&n.data&&(z(parseInt(t==null?void 0:t.current_page)),C(t==null?void 0:t.prev_page_url),U(t==null?void 0:t.next_page_url),I(t==null?void 0:t.last_page),w(t))}).catch(n=>{console.log(n)}).finally(()=>{$("loading",!1)})},O=B.debounce(p,1e3);return a.useEffect(()=>{p()},[N]),a.useEffect(()=>{h!=d&&S(d)},[d]),a.useEffect(()=>{h!=d&&O(`${x}?page=${h}`)},[h]),e.jsx("div",{className:"w-full h-full py-4",...b,children:e.jsxs(M,{className:"bg-white h-full w-full",children:[e.jsxs(K,{justifyContent:"start",className:"space-x-2",children:[e.jsx(T,{children:"Farmers"}),e.jsx(j,{color:"gray",children:G(parseInt((l==null?void 0:l.total)||0))})]}),e.jsx(H,{className:"mt-2",children:"Overview of farmers profiled"}),e.jsxs(J,{className:"mt-6",children:[e.jsx(W,{children:e.jsxs(A,{children:[e.jsx(c,{children:"Farmer ID"}),e.jsx(c,{children:"Name"}),e.jsx(c,{children:"Phone"}),e.jsx(c,{children:"FPO"}),e.jsx(c,{className:"",children:"District"}),e.jsx(c,{className:"",children:"Registered On"}),e.jsx(c,{className:"",children:"Status"}),e.jsx(c,{children:"Link"})]})}),e.jsx(Y,{children:(v=l==null?void 0:l.data)==null?void 0:v.map(s=>{var n,t,u,E;return e.jsxs(A,{children:[e.jsx(i,{children:s.farmer_id}),e.jsx(i,{children:s.first_name+" "+s.last_name}),e.jsx(i,{children:s.phone_number||"N/A"}),e.jsx(i,{children:s.fpo_name||((n=s==null?void 0:s.fpo)==null?void 0:n.fpo_name)||((u=(t=s==null?void 0:s.agent)==null?void 0:t.fpo)==null?void 0:u.fpo_name)}),e.jsx(i,{className:"",children:s.district}),e.jsx(i,{children:(E=new Date(s==null?void 0:s.created_at))==null?void 0:E.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}),e.jsx(i,{children:s.status==="complete"?e.jsx(j,{className:"capitalize",size:"md",color:"green",children:s==null?void 0:s.status}):(s==null?void 0:s.status)==="pending"?e.jsx(j,{className:"capitalize",size:"md",color:"gray",children:s==null?void 0:s.status}):e.jsx(j,{className:"capitalize",size:"md",color:"red",children:s==null?void 0:s.status})}),e.jsx(i,{children:e.jsx(q,{size:"xs",variant:"secondary",color:"orange",onClick:()=>{r(`${Q}/${s==null?void 0:s.farmer_id}`)},children:"See details"})})]},s.id)})})]}),e.jsx(V,{currentPage:d,moveToPage:h,fetchPage:p,setMoveToPage:S,nextPageUrl:R,prevPageUrl:L,lastPage:F,totalPages:l==null?void 0:l.last_page})]})})}export{f as default};
