import{b as z,u as k,r as i,A as L,l as O,j as e,D as T,B as A,d as Y,P as M}from"./app-cf4561db.js";import{b as j,a as q,e as H,A as J,m as _,t as K,v as D,w as I,x as r,y as G,z as o,F as Q,u as V,s as b,d as W,h as X,i as v,n as Z,j as S}from"./Tracker-81743c79.js";import{n as N}from"./numberFormatter-373bc269.js";import{P as ee}from"./index-f32d38b8.js";import{S as se,C as te,a as ne}from"./square-stack-5a5f3bcf.js";import"./Transition-927311f7.js";import"./default-config-939e3be8.js";function ae($){var y;const d=z(),c=k(t=>t.auth.token),{updateAppContextState:g}=i.useContext(L),[u,B]=i.useState(1),[h,f]=i.useState(1),[x,s]=i.useState(1),[m,p]=i.useState(""),[P,R]=i.useState(""),[l,w]=i.useState({}),E=`${A}/farmers/bio`,C=(t=E)=>{g("loading",!0),Y.get(t,{headers:{API_KEY:M,Authorization:`Bearer ${c}`}}).then(n=>{var F;let a=(F=n.data)==null?void 0:F.data;console.log("Profiles",a),n!=null&&n.data&&(B(parseInt(a==null?void 0:a.current_page)),p(a==null?void 0:a.prev_page_url),R(a==null?void 0:a.next_page_url),s(a==null?void 0:a.last_page),w(a))}).catch(n=>{console.log(n)}).finally(()=>{g("loading",!1)})},U=O.debounce(C,1e3);return i.useEffect(()=>{C()},[c]),i.useEffect(()=>{h!=u&&f(u)},[u]),i.useEffect(()=>{h!=u&&U(`${E}?page=${h}`)},[h]),e.jsx("div",{className:"w-full h-full py-4",children:e.jsxs(j,{className:"bg-white h-full w-full",children:[e.jsxs(q,{justifyContent:"start",className:"space-x-2",children:[e.jsx(H,{children:"Biometrics"}),e.jsx(J,{color:"gray",children:N(parseInt((l==null?void 0:l.total)||0))})]}),e.jsx(_,{className:"mt-2",children:"Overview of Biometrics captured"}),e.jsxs(K,{className:"mt-6",children:[e.jsx(D,{children:e.jsxs(I,{children:[e.jsx(r,{children:"Farmer ID"}),e.jsx(r,{children:"Name"}),e.jsx(r,{children:"Enrollment Status"}),e.jsx(r,{children:"Possible Duplicate"}),e.jsx(r,{className:"",children:"Has BioToken"}),e.jsx(r,{className:"",children:"Reason"}),e.jsx(r,{className:"",children:"Registered On"}),e.jsx(r,{className:"",children:"Subject ID"}),e.jsx(r,{children:"Link"})]})}),e.jsx(G,{children:(y=l==null?void 0:l.data)==null?void 0:y.map(t=>{var a;let n=t.farmer_profile;return e.jsxs(I,{children:[e.jsx(o,{children:n.farmer_id}),e.jsx(o,{children:n.first_name+" "+n.last_name}),e.jsx(o,{children:t==null?void 0:t.enrollmentStatus}),e.jsx(o,{children:t!=null&&t.possible_duplicate?"Yes":"No"}),e.jsx(o,{className:"",children:t!=null&&t.hasBiometricToken?"Yes":"No"}),e.jsx(o,{className:"",children:(t==null?void 0:t.reason)||"No Reason"}),e.jsx(o,{children:(a=new Date(n==null?void 0:n.created_at))==null?void 0:a.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}),e.jsx(o,{children:t==null?void 0:t.subjectID}),e.jsx(o,{children:e.jsx(Q,{size:"xs",variant:"secondary",color:"orange",onClick:()=>{d(`${T}/${n==null?void 0:n.farmer_id}`)},children:"See details"})})]},n.id)})})]}),e.jsx(ee,{currentPage:u,moveToPage:h,fetchPage:C,setMoveToPage:f,nextPageUrl:P,prevPageUrl:m,lastPage:x,totalPages:l==null?void 0:l.last_page})]})})}const de=()=>{const $=k(x=>x.auth.token),{updateAppContextState:d}=i.useContext(L),[c,g]=i.useState({}),[u,B]=i.useState({}),h=(x=`${A}/summary`)=>{d("loading",!0),axios.get(x,{headers:{Authorization:`Bearer ${$}`}}).then(s=>{console.log("Stats Data",s==null?void 0:s.data);let m=s==null?void 0:s.data;s!=null&&s.data&&B(m)}).catch(s=>{console.log(s)}).finally(()=>{d("loading",!1)})},f=(x=`${A}/bio/summary`)=>{d("loading",!0),axios.get(x,{headers:{Authorization:`Bearer ${$}`}}).then(s=>{var p,P;console.log("Bio Summary Data",(p=s==null?void 0:s.data)==null?void 0:p.data);let m=(P=s==null?void 0:s.data)==null?void 0:P.data;s!=null&&s.data&&g(JSON.parse(m))}).catch(s=>{console.log(s)}).finally(()=>{d("loading",!1)})};return i.useEffect(()=>{h(),f()},[]),e.jsxs(e.Fragment,{children:[e.jsxs(V,{numItemsSm:2,numItemsLg:3,className:"gap-6 mt-4",children:[e.jsxs(j,{children:[e.jsx(_,{children:"Biometrics Captured"}),e.jsx(b,{children:N(c==null?void 0:c.bio_summary)})]}),e.jsxs(j,{children:[e.jsx(_,{children:"Denied Captures"}),e.jsx(b,{children:N(c==null?void 0:c.denied_captures)})]}),e.jsxs(j,{children:[e.jsx(_,{children:"Possibe Duplicates"}),e.jsx(b,{children:N(c==null?void 0:c.possible_duplicates)})]})]}),e.jsx(j,{className:"mt-4",children:e.jsxs(W,{children:[e.jsxs(X,{className:"",children:[e.jsx(v,{icon:se,children:"Biometrics Captured"}),e.jsx(v,{icon:te,children:"Denied Captures"}),e.jsx(v,{icon:ne,children:"Possible Duplicates"})]}),e.jsxs(Z,{children:[e.jsx(S,{children:e.jsx(ae,{})}),e.jsx(S,{children:e.jsx(e.Fragment,{})}),e.jsx(S,{children:e.jsx(e.Fragment,{})}),e.jsx(S,{})]})]})})]})};export{de as default};
