import{b as U,u as f,r as l,A as k,l as O,j as t,D as B,B as m,d as M,P as T}from"./app-25da55ac.js";import{b as K,a as Y,e as q,A as r,m as G,t as H,v as J,w as b,x as i,y as Q,z as o,F as V}from"./Tracker-2ee0a400.js";import{n as W}from"./numberFormatter-373bc269.js";import{P as X}from"./index-09d89ba6.js";import"./Transition-afe206db.js";import"./default-config-939e3be8.js";function ae({fpo_id:g,agent_id:P,...n}){var v;const E=U(),N=f(e=>e.auth.token),{updateAppContextState:S}=l.useContext(k),[d,A]=l.useState(1),[h,$]=l.useState(1),[F,y]=l.useState(1),[z,w]=l.useState(""),[C,I]=l.useState(""),[c,L]=l.useState({});let j=`${m}/farmers`;g&&(j=`${m}/fpo/${g}/farmers`),P&&(j=`${m}/agent/${P}/farmers`);const _=(e=j)=>{S("loading",!0),n!=null&&n.bio_url&&(e=n==null?void 0:n.bio_url),console.log(e),M.get(e,{headers:{API_KEY:T,Authorization:`Bearer ${N}`}}).then(a=>{var x,u;let s=a==null?void 0:a.data;(g||P)&&(s=(x=a.data)==null?void 0:x.data),n!=null&&n.bio_url&&(s=(u=a.data)==null?void 0:u.data),console.log("Profiles",s),a!=null&&a.data&&(A(parseInt(s==null?void 0:s.current_page)),w(s==null?void 0:s.prev_page_url),I(s==null?void 0:s.next_page_url),y(s==null?void 0:s.last_page),L(s))}).catch(a=>{console.log(a)}).finally(()=>{S("loading",!1)})},R=O.debounce(_,1e3);return l.useEffect(()=>{_()},[N]),l.useEffect(()=>{h!=d&&$(d)},[d]),l.useEffect(()=>{h!=d&&R(`${j}?page=${h}`)},[h]),t.jsx("div",{className:"w-full h-full py-4",children:t.jsxs(K,{className:"bg-white h-full w-full",children:[t.jsxs(Y,{justifyContent:"start",className:"space-x-2",children:[t.jsx(q,{children:"Farmers"}),t.jsx(r,{color:"gray",children:W(parseInt((c==null?void 0:c.total)||0))})]}),t.jsx(G,{className:"mt-2",children:"Overview of farmers profiled"}),t.jsxs(H,{className:"mt-6",children:[t.jsx(J,{children:t.jsxs(b,{children:[t.jsx(i,{children:"Farmer ID"}),t.jsx(i,{children:"Name"}),t.jsx(i,{children:"Phone"}),t.jsx(i,{children:"FPO"}),t.jsx(i,{className:"",children:"District"}),t.jsx(i,{className:"",children:"Registered On"}),t.jsx(i,{className:"",children:"Status"}),t.jsx(i,{children:"Link"})]})}),t.jsx(Q,{children:(v=c==null?void 0:c.data)==null?void 0:v.map(e=>{var a,s,x,u;return t.jsxs(b,{children:[t.jsx(o,{children:e.farmer_id}),t.jsx(o,{children:e.first_name+" "+e.last_name}),t.jsx(o,{children:e.phone_number}),t.jsx(o,{children:e.fpo_name||((a=e==null?void 0:e.fpo)==null?void 0:a.fpo_name)||((x=(s=e==null?void 0:e.agent)==null?void 0:s.fpo)==null?void 0:x.fpo_name)}),t.jsx(o,{className:"",children:e.district}),t.jsx(o,{children:(u=new Date(e==null?void 0:e.created_at))==null?void 0:u.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}),t.jsx(o,{children:e.status==="complete"?t.jsx(r,{className:"capitalize",size:"md",color:"green",children:e==null?void 0:e.status}):t.jsx(r,{className:"capitalize",size:"md",color:"red",children:e==null?void 0:e.status})}),t.jsx(o,{children:t.jsx(V,{size:"xs",variant:"secondary",color:"orange",onClick:()=>{E(`${B}/${e==null?void 0:e.farmer_id}`)},children:"See details"})})]},e.id)})})]}),t.jsx(X,{currentPage:d,moveToPage:h,fetchPage:_,setMoveToPage:$,nextPageUrl:C,prevPageUrl:z,lastPage:F,totalPages:c==null?void 0:c.last_page})]})})}export{ae as default};
