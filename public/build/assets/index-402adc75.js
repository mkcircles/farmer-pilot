import{b as L,u as R,r as n,A as U,l as k,j as e,z as O,B as r,c as f,M as B}from"./app-148b5813.js";import{b as M,a as T,e as K,A as p,m as Y,t as q,v as G,w as $,x as c,y as H,z as i,E as J}from"./Tracker-80364376.js";import{n as Q}from"./numberFormatter-373bc269.js";import{P as V}from"./index-77495178.js";import"./Transition-4aa677f3.js";import"./default-config-939e3be8.js";function ts({fpo_id:u,agent_id:j}){var N;const v=L(),P=R(s=>s.auth.token),{updateAppContextState:_}=n.useContext(U),[o,E]=n.useState(1),[d,m]=n.useState(1),[A,y]=n.useState(1),[z,F]=n.useState(""),[b,w]=n.useState(""),[l,C]=n.useState({});let x=`${r}/farmers`;u&&(x=`${r}/fpo/${u}/farmers`),j&&(x=`${r}/agent/${j}/farmers`);const g=(s=x)=>{_("loading",!0),console.log(s),f.get(s,{headers:{API_KEY:B,Authorization:`Bearer ${P}`}}).then(a=>{var h;let t=a==null?void 0:a.data;(u||j)&&(t=(h=a.data)==null?void 0:h.data),console.log("Profiles",t),a!=null&&a.data&&(E(parseInt(t==null?void 0:t.current_page)),F(t==null?void 0:t.prev_page_url),w(t==null?void 0:t.next_page_url),y(t==null?void 0:t.last_page),C(t))}).catch(a=>{console.log(a)}).finally(()=>{_("loading",!1)})},I=k.debounce(g,1e3);return n.useEffect(()=>{g()},[P]),n.useEffect(()=>{d!=o&&m(o)},[o]),n.useEffect(()=>{d!=o&&I(`${x}?page=${d}`)},[d]),e.jsx("div",{className:"w-full h-full py-4",children:e.jsxs(M,{className:"bg-white h-full w-full",children:[e.jsxs(T,{justifyContent:"start",className:"space-x-2",children:[e.jsx(K,{children:"Farmers"}),e.jsx(p,{color:"gray",children:Q(parseInt((l==null?void 0:l.total)||0))})]}),e.jsx(Y,{className:"mt-2",children:"Overview of farmers profiled"}),e.jsxs(q,{className:"mt-6",children:[e.jsx(G,{children:e.jsxs($,{children:[e.jsx(c,{children:"Farmer ID"}),e.jsx(c,{children:"Name"}),e.jsx(c,{children:"Phone"}),e.jsx(c,{children:"FPO"}),e.jsx(c,{className:"",children:"District"}),e.jsx(c,{className:"",children:"Registered On"}),e.jsx(c,{className:"",children:"Status"}),e.jsx(c,{children:"Link"})]})}),e.jsx(H,{children:(N=l==null?void 0:l.data)==null?void 0:N.map(s=>{var a,t,h,S;return e.jsxs($,{children:[e.jsx(i,{children:s.farmer_id}),e.jsx(i,{children:s.first_name+" "+s.last_name}),e.jsx(i,{children:s.phone_number}),e.jsx(i,{children:s.fpo_name||((a=s==null?void 0:s.fpo)==null?void 0:a.fpo_name)||((h=(t=s==null?void 0:s.agent)==null?void 0:t.fpo)==null?void 0:h.fpo_name)}),e.jsx(i,{className:"",children:s.district}),e.jsx(i,{children:(S=new Date(s==null?void 0:s.created_at))==null?void 0:S.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}),e.jsx(i,{children:s.status==="complete"?e.jsx(p,{className:"capitalize",size:"md",color:"green",children:s==null?void 0:s.status}):e.jsx(p,{className:"capitalize",size:"md",color:"red",children:s==null?void 0:s.status})}),e.jsx(i,{children:e.jsx(J,{size:"xs",variant:"secondary",color:"orange",onClick:()=>{v(`${O}/${s==null?void 0:s.farmer_id}`)},children:"See details"})})]},s.id)})})]}),e.jsx(V,{currentPage:o,moveToPage:d,fetchPage:g,setMoveToPage:m,nextPageUrl:b,prevPageUrl:z,lastPage:A,totalPages:l==null?void 0:l.last_page})]})})}export{ts as default};
